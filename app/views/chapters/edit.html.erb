<% crumbs_for @chapter, leaf: false %>
<% breadcrumb 'Edit' %>

<%= render 'subheader' %>

<% content_for :javascript do %>
  <%= javascript_include_tag "/assets/tinymce/tinymce.min.js", id: 'tinymceScript' %>
<% end %>

<div class="flex-col w-full">
  <h1 class="text-2xl font-bold">Edit Chapter</h1>

  <%= render 'form', chapter: @chapter %>

  <% if flash[:stale_uuid] %>
    <div data-controller="draft-cleaner"
         data-draft-cleaner-uuid-value="<%= flash[:stale_uuid] %>"
         data-draft-cleaner-parent-value="<%= flash[:parent_key] %>"
         class="hidden"></div>
  <% end %>
</div>

<%= render 'track_sheet_updates/picker', id: 'trackSheetPicker' %>
<%= render 'chapters/edit_renderer' %>

<script id="tsImageTagTemplate" type="text/x-handlebars-template">
  <%= stylesheet_link_tag "tailwind", "inter-font", "application" %>
  <div class="group relative flex flex-col text-black gap-2 border border-white hover:border-gray-300 hover:bg-gray-50 p-2">
    <div class="invisible group-hover:visible absolute top-0 left-0 bg-gray-50 opacity-70 text-sm ml-2 mt-2 px-2 py-1">{{filename}}</div>
    <div class="remove-image invisible group-hover:visible absolute top-0 right-0 bg-red-50 hover:bg-red-100 text-red-500 font-sans text-sm opacity-70 mr-2 mt-2 px-2 py-1 cursor-pointer">X</div>
    <div>
      <img src="{{url}}" alt="{{alt}}" width="{{width}}" height="{{height}}" class="border border-dashed border-white group-hover:border-gray-300 w-auto h-auto mx-auto" />
    </div>
    <div class="w-3/4 mx-auto flex flex-col">
      <span class="text-sm text-gray-400 ml-2">Image Alt Text:</span>
      <input type="text" name="alt" value="{{alt}}" class="px-2 py-1 rounded border-gray-400" />
      <span class="text-sm text-gray-400 ml-2">Image Caption:</span>
      <input type="text" name="caption" value="{{caption}}" class="px-2 py-1 rounded border-gray-400" />
      <span class="text-sm text-gray-400 ml-2">Image Credits:</span>
      <input type="text" placeholder="e.g. &quot;Photograph by John Shutterbug&quot;, or &quot;Artist: Jane Painter&quot;" name="ack" value="{{ack}}" class="px-2 py-1 rounded border-gray-400" />
    </div>
  </div>
</script>
